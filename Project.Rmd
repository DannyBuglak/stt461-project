---
title: "Group Project"
author: "Beau Belkowski, Brian Marquardt, Danny Buglak"
date: '2024-02-27'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(cluster)
library(ggplot2)
```

```{r}
getwd()
#y2021 <- read.csv("2021.csv")
```

```{r}
y2021 <- read.csv("2021.csv")
y2019 <- read.csv("2019.csv")
y2018 <- read.csv("2018.csv")
y2017 <- read.csv("2017.csv")
y2016 <- read.csv("2016.csv")

y2021
y2019
y2018
y2017
y2016
```

```{r}
y2021$G <- as.double(y2021$G)
y2021$GS <- as.double(y2021$GS)
y2021$Age <- as.double(y2021$Age)
#y2021
```

```{r}
y2021$year<- rep('2021', times= nrow(y2021))
y2021.1 <- y2021[,-1]
#y2021.1
y2018$year<- rep('2018', times= nrow(y2018))
y2018.1 <- y2018[,-1]
#y2018.1
y2019$year<- rep('2019', times= nrow(y2019))
y2019.1 <- y2019[,-1]
#y2019.1
y2017$year<- rep('2017', times= nrow(y2017))
y2017.1 <- y2017[,-1]
#y2017.1
y2016$year<- rep('2016', times= nrow(y2016))
y2016.1 <- y2016[,-1]
#y2016.1


fb <- rbind(y2021.1, y2019.1, y2018.1, y2017.1, y2016.1)
#fb
```
```{r}
fb$Tgt_gm <- fb$Tgt/fb$G
fb$Rec_gm <- fb$Rec/fb$G
fb$PassingYds_gm <- fb$PassingYds/fb$G
fb$PassingTD_gm <- fb$PassingTD/fb$G
fb$PassingAtt_gm <- fb$PassingAtt/fb$G
fb$RushingYds_gm <- fb$RushingYds/fb$G
fb$RushingTD_gm <- fb$RushingTD/fb$G
fb$RushingAtt_gm <- fb$RushingAtt/fb$G
fb$ReceivingYds_gm <- fb$ReceivingYds/fb$G
fb$ReceivingTD_gm <- fb$ReceivingTD/fb$G
fb$FantasyPoints_gm <- fb$FantasyPoints/fb$G
fb$Int_gm <- fb$Int/fb$G
fb$Fumbles_gm <- fb$Fumbles/fb$G
fb$FumblesLost_gm <- fb$FumblesLost/fb$G
summary(fb)
```

```{r}
fb1 <- fb %>%
  filter(GS >= 5, FantasyPoints_gm > 0)
fb1
```


```{r}
rb <- fb1 %>%
  filter(Pos == "RB")
qb <- fb1 %>%
  filter(Pos == "QB")
wr <- fb1 %>%
  filter(Pos == "WR")
te <- fb1 %>%
  filter(Pos == "TE")
rb
qb
wr
te
```

```{r}

ggplot(data = fb1, aes(x = FantasyPoints_gm)) + 
  geom_histogram() +
  ggtitle("Distribution of Fantasy Points per Game")

ggplot(data = rb, aes(x = RushingYds_gm)) + 
  geom_histogram() +
  ggtitle("Distribution of Runningbacks Rushing Yards per Game")

ggplot(data = qb, aes(x = PassingTD_gm)) + 
  geom_histogram() +
  ggtitle("Distribution of Quarterbacks Passing Touchdowns per Game")

ggplot(data = rb, aes(x = FantasyPoints_gm, y = RushingYds_gm)) + 
  geom_point() +
  ggtitle("Correlation for Running Backs Fantasy Points per Game and Rushing Yards per Game")

ggplot(data = fb1, aes(x = FantasyPoints_gm, y = FumblesLost_gm)) + 
  geom_point() +
  ggtitle("Correlation Between Fantasy Points per Game and Fumbles Lost per Game")

ggplot(data = wr, aes(x = FantasyPoints_gm, y = ReceivingTD_gm)) + 
  geom_point() +
  ggtitle("Correlation for Wide Recievers Fantasy Points per Game and Recieving Touchdowns per Game")
```









## Clustering Analysis

```{r}
set.seed(20)

# Remove name and team and omit any NA values
clust_fb <- fb1 %>% 
  select(-c("Player", "Tm")) %>%
  na.omit()

# Scale the data to normalize it
normalized_fb <- scale(clust_fb[, sapply(clust_fb, is.numeric)])

# Determine the optimal number of clusters using Elbow method
elbow <- sapply(1:15, function(k) {
  kmeans(normalized_fb, centers = k, nstart = 50)$tot.withinss
  })
plot(1:15, elbow, type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
```

Elbow Method shows that 4 is the optimal number of clusters. This is because 4 is when the line on the graph "elbows", or where it begins to shallow out and any more clusters than 4 do not change the analysis by much.

```{r}
# Number of clusters found from the previous Elbow plot
k <- 4

# Perform kmeans on normalized dataset
kmeans_analysis <- kmeans(normalized_fb, centers = k, nstart = 50)

# Add clusters to dataset
clust_fb$cluster <- as.factor(kmeans_analysis$cluster)
clust_fb

#library(dplyr)
#library(ggplot2)

# Example: Summary statistics by Pos and cluster
#clust_fb %>%
#  group_by(Pos, cluster) %>%
#  summarise(mean_fantasy_points = mean(FantasyPoints_gm, na.rm = TRUE),
#            n = n())

# Example: Plotting
#ggplot(clust_fb, aes(x = FantasyPoints_gm, fill = cluster)) +
#  geom_histogram(bins = 30, alpha = 0.6) +
#  facet_wrap(~Pos) +
#  labs(title = "Fantasy Points per Game Distribution by Position and Cluster",
#       x = "Fantasy Points per Game",
#       y = "Count")
```


